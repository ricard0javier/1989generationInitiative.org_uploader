language: java

jdk:
    - oraclejdk8

script: gradle build

before_cache:
    - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
    - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
    directories:
        - $HOME/.gradle/caches/
        - $HOME/.gradle/wrapper/

deploy:
    skip_cleanup: true
    provider: lambda
    function_name: "1989generationinitiative_uploader"
    role: "arn:aws:iam::430132907316:role/initiativeRole"
    handler_name: "org.generationinitiative.uploader.Hello"
    access_key_id: "$AWS_ACCESS_KEY_ID"
    secret_access_key: "$AWS_SECRET_ACCESS_KEY"